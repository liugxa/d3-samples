<!DOCTYPE html>
<html>
	<head>
		<script src="./js/d3.js" charset="utf-8"></script>
		<script src="./js/rave.js" charset="utf-8"></script>
		<script src="./js/jdependency/jdependency.js" charset="utf-8"></script>
	</head>
		
	<body>
	
		View Job Dependencies: #jobId
		<div id="canvas" style="width:800px;height:600px"/>
		<script>
			var urlContext = window.location.href + "/..";
			var jdContext = new JDContext("#canvas", urlContext, true);
			var jdCanvas = new JDCanvas(jdContext);
			
			function getDiagrams(){
				var diagrams = {};
				
				//parent diagrams
				var pDiagrams = [];
				for(var i=0;i<10;i++){
					var diagram = {};
					diagram.id = "job" + i;
					diagram.label = "Job (" + i +") ";
					diagram.type = "job";
					diagram.state = "running";
					diagram.dependencies = [];
					pDiagrams.push(diagram);
				}
				diagrams.parents = pDiagrams;
				
				var pDependencies = [];
				for(var i=0;i<pDiagrams.length;i++){
					var dependency = {};
					dependency.depended = pDiagrams[i];
					dependency.condition = "Done";
					pDependencies.push(dependency);
				}
				
				//current diagram
				var cDiagram = {
					id: "job11",
					label: "MyJob" + " (11) ",
					type: "job",
					state: "pending",
					dependencies: pDependencies
				};
				diagrams.current = cDiagram;
				
				//child diagrams
				var cDiagrams = [];
				for(var i=0;i<3;i++){
					var diagram = {};
					diagram.id = "job" + (pDiagrams.length + 2 + i);
					diagram.label = "Job (" + (pDiagrams.length + 2 + i) + ") ";
					diagram.type = "job";
					diagram.state = "waiting";
					
					var dependencies = [];
					var dependency = {};
					dependency.depended = cDiagram;
					dependency.condition = "Done";
					
					dependencies.push(dependency);
					diagram.dependencies = dependencies;
					
					cDiagrams.push(diagram);
				}
				diagrams.childrens = cDiagrams;
				
				return diagrams;
			}
			
			function testShowDiagrams(){
				jdCanvas.diagrams = getDiagrams();
				jdCanvas.show();
			}
			
			function main(){
				//show diagram on excel position
				testShowDiagrams();
			}
			main()
		</script>
	</body>

</html>